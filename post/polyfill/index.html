<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Polyfill | ğŸ¦Œ</title>
<link rel="shortcut icon" href="https://croatiaparanoia.github.io/blog//favicon.ico?v=1609758811482">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://croatiaparanoia.github.io/blog//styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Polyfill | ğŸ¦Œ - Atom Feed" href="https://croatiaparanoia.github.io/blog//atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="å¬é—»ä½ è¿™åŒ…ä¸æ„¿ç»™æˆ‘åŠ polyfillï¼Ÿ

æ›¾ç»æœ‰å†™äº†ä¸ªå·¥å…·åº“å‘åˆ°äº†npmï¼Œ æœ€è¿‘æœ‰ä½è€å“¥è¯´è¿™ä¸ªåº“ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸å…¼å®¹ï¼Œ å¦‚ æ•°ç»„çš„ includes æ–¹æ³•ä¹‹ç±»çš„ã€‚æˆ‘éšå³çœ‹äº†ä¸‹ï¼Œç¡®å®å¼ï¼Œ tsc åªæ˜¯æŠŠè¯­æ³•ç³–çš„è½¬è¯‘äº†ï¼Œ è‡³äºé«˜çº§APIç‰¹æ€§çš„ï¼Œè¿˜..." />
    <meta name="keywords" content="Babel,Polyfill" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://croatiaparanoia.github.io/blog/">
  <img class="avatar" src="https://croatiaparanoia.github.io/blog//images/avatar.png?v=1609758811482" alt="">
  </a>
  <h1 class="site-title">
    ğŸ¦Œ
  </h1>
  <p class="site-description">
    ä¸‡ç‰©çš†æœ‰è£‚ç—•ï¼Œé‚£æ˜¯å…‰ç…§è¿›æ¥çš„åœ°æ–¹ã€‚
  </p>
  <div class="menu-container">
    
      
        <a href="/blog/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/blog/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/blog/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/blog/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/CroatiaParanoia" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Polyfill
            </h2>
            <div class="post-info">
              <span>
                2020-11-11
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://croatiaparanoia.github.io/blog/tag/VRD_CJ-v7/" class="post-tag">
                  # Babel
                </a>
              
                <a href="https://croatiaparanoia.github.io/blog/tag/zGLDGp_EhB/" class="post-tag">
                  # Polyfill
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://croatiaparanoia.github.io/blog//post-images/polyfill.jpeg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="å¬é—»ä½ è¿™åŒ…ä¸æ„¿ç»™æˆ‘åŠ polyfill">å¬é—»ä½ è¿™åŒ…ä¸æ„¿ç»™æˆ‘åŠ polyfillï¼Ÿ</h1>
<figure data-type="image" tabindex="1"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758259689.jpg" alt="" loading="lazy"></figure>
<p>æ›¾ç»æœ‰å†™äº†ä¸ªå·¥å…·åº“å‘åˆ°äº†npmï¼Œ æœ€è¿‘æœ‰ä½è€å“¥è¯´è¿™ä¸ªåº“ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸å…¼å®¹ï¼Œ å¦‚ æ•°ç»„çš„ includes æ–¹æ³•ä¹‹ç±»çš„ã€‚æˆ‘éšå³çœ‹äº†ä¸‹ï¼Œç¡®å®å¼ï¼Œ tsc åªæ˜¯æŠŠè¯­æ³•ç³–çš„è½¬è¯‘äº†ï¼Œ è‡³äºé«˜çº§APIç‰¹æ€§çš„ï¼Œè¿˜æ˜¯é‚£ä¸ªæ ·å­ã€‚</p>
<p>éšå³å‡†å¤‡ç»™åº“åŠ polyfillï¼Œ ä½†æ˜¯æƒ³äº†ä¸‹ã€‚ å˜¿ï¼Œ è¿™ç¬¬ä¸‰æ–¹åº“çš„ï¼Œ æˆ‘è¦æ˜¯åŠ äº†polyfillï¼Œ é‚£è¦æ˜¯æœ‰å…¶ä»–äººä¸è€ƒè™‘æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜çš„å‘¢ï¼Œ é‚£å²‚ä¸æ˜¯polyfillå¾—ä»£ç éƒ½ç”¨ä¸åˆ°ï¼Œ å¾’å¢ä½“ç§¯ï¼Ÿ</p>
<figure data-type="image" tabindex="2"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758267270.jpg" alt="" loading="lazy"></figure>
<p>é‚£å¥½å‹’ï¼Œ æ—¢ç„¶è¿™ç¬¬ä¸‰æ–¹åº“ä¸æ‰“ç®—æ•´åˆpolyfillï¼Œ é‚£å°±æ˜¯è®©ä½¿ç”¨æ–¹å»ç”¨babelè½¬è¯‘è¿™ä¸ªç¬¬ä¸‰æ–¹åº“äº†ã€‚ä½†æ˜¯ç¬¬ä¸‰æ–¹è¡Œä¸è¡Œå‘¢ï¼Œ æˆ‘å¿ƒé‡Œè¿˜çœŸå‘æ€µï¼Œä¹Ÿä¸æ•¢ç›´æ¥è·Ÿäººå®¶è¯´ï¼Œæœ¬ç€æ¯›ä¸»å¸­çš„â€œæ²¡æœ‰è°ƒæŸ¥å°±æ²¡æœ‰å‘è¨€æƒâ€åŸåˆ™ï¼Œ æˆ‘å†³å®šè‡ªå·±å» try ä¸€ tryã€‚</p>
<h2 id="éšä¾¿æä¸ªé¡¹ç›®">éšä¾¿æä¸ªé¡¹ç›®</h2>
<p>é¦–å…ˆï¼Œ é‚£å°±æ˜¯é¡¹ç›®åŸºç¡€äº†ã€‚</p>
<pre><code class="language-shell">mkdir support-ie

cd support-ie

npm init -y

yarn add webpack webpack-cli --dev

# è£…ä¸Šæˆ‘é‚£ä¸ªå¯æ€œçš„åŒ…
yarn add ffformat

# è£…ä¸Š babel ç›¸å…³ä¾èµ–
yarn add @babel/core @babel/preset-env @babel/plugin-transform-run-time babel-loader --dev

# è£…ä¸Š core-jsã€‚ æŒ‰éœ€å¼•å…¥ polyfill ä¹‹ç±»çš„å°±å–è¿™é‡Œé¢çš„äº†
yarn add core-js

# åˆ›å»º webpack é…ç½®æ–‡ä»¶
touch webpack.config.js

# åˆ›å»º babel é…ç½®æ–‡ä»¶ 
touch babel.config.json

# æºä»£ç æ–‡ä»¶
mkdir src &amp;&amp; cd src &amp;&amp; touch main.js
</code></pre>
<p>æ–‡ä»¶åˆ›å»ºçš„å·®ä¸å¤šï¼Œç„¶åå°±æ˜¯é…åˆ¶ config æ–‡ä»¶äº†</p>
<pre><code class="language-javascript">// webpack.config.js
const path = require(&quot;path&quot;);

module.exports = {
  entry: {
    main: &quot;./src/main.js&quot;,
  },
  output: &quot;/dist/main.js&quot;,
  module: {
    rules: [
      {
        test: /\.js$/,
        loader: &quot;babel-loader&quot;,
        include: [
          path.resolve(__dirname, &quot;./src&quot;),
          // è¿™é‡Œè¦æŠŠç¬¬ä¸‰æ–¹åŒ…åŠ å…¥åˆ°includeä¸­ï¼Œ ä¸ç„¶loaderä¸ä¼šå»è½¬è¯‘
          path.resolve(__dirname, &quot;node_modules/ffformat&quot;),
        ],
      },
    ],
  },
  optimization: {
    minimize: false,
  },
};
</code></pre>
<p>æ¥ç€æ˜¯babel çš„é…ç½®æ–‡ä»¶</p>
<pre><code class="language-json">// babel.config.json
{
  &quot;presets&quot;: [
    [
      &quot;@babel/env&quot;,
      {
        // æŒ‡æ˜ corejs çš„ç‰ˆæœ¬ï¼Œï¼ˆä¸åŒç‰ˆæœ¬çš„æ–‡ä»¶å’Œå‘½åæ–¹å¼æœ‰åŒºåˆ«ï¼Œé¿å…æ‰¾æ–‡ä»¶æŠ¥é”™ï¼Œ æ‰€ä»¥è¦æŒ‡æ˜ç‰ˆæœ¬ï¼‰
        &quot;corejs&quot;: 3,
        // å…¼å®¹ie9
        &quot;targets&quot;: {
          &quot;ie&quot;: 9,
        },
        // ä½¿ç”¨è¿™ä¸ªæŒ‰éœ€å¼•å…¥polyfill
        &quot;useBuiltIns&quot;: &quot;usage&quot;
      }
    ]
  ]
}
</code></pre>
<p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å¼€å§‹åœ¨ <code>src/main.js</code> å†™ä¸Šä¸€æ®µä»£ç </p>
<pre><code class="language-javascript">// src/main.js
import * as ffformat from 'ffforamt';

console.log(ffformat);
</code></pre>
<p>ç„¶åæ ¹ç›®å½•è¿è¡Œwebpackä¸€æ¬¡ **<code>npx webpack</code> **</p>
<p>å°±å¯ä»¥çœ‹åˆ° æ‰“åŒ… <code>main.js</code> çš„æ—¶å€™ï¼Œ å¼•å…¥äº†ä¸€äº› <code>core-js</code> ä¸‹é¢çš„æ¨¡å—ï¼Œ å»çœ‹ dist/main.js ï¼Œ å°±èƒ½çœ‹åˆ°é’ˆå¯¹ä¸€äº›é«˜çº§ç‰¹æ€§ï¼Œ æœ‰åšäº† polyfillã€‚</p>
<p>è‡´æ­¤ï¼Œ æ­£å¸¸æµç¨‹å®Œã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758276421.jpg" alt="" loading="lazy"></figure>
<h2 id="é‡åˆ°çš„é—®é¢˜">é‡åˆ°çš„é—®é¢˜</h2>
<h3 id="1-babel-é…ç½®æ–‡ä»¶çš„é—®é¢˜">1. Babel é…ç½®æ–‡ä»¶çš„é—®é¢˜</h3>
<p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œ ç”¨çš„æ˜¯ <code>.babelrc</code> æ¥é…ç½®babelï¼Œ ç»“æœloader ä¸€ç›´ä¸èµ° <code>node_modules</code> ï¼Œ ä¸è½¬è¯‘ <code>node_modules</code> ä¸­çš„ä»£ç ï¼Œå¡äº†åŠå¤©ï¼Œä¸æ–­æ‰¾æ–‡ç« ï¼Œåæ¥å‘ç°äº†ä¸€ä½è€å“¥çš„è¯ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758282188.png" alt="" loading="lazy"></figure>
<p>éšå³å°† <code>.babelrc</code>  é‡å‘½åä¸º <code>babel.config.json</code>ï¼Œ å† <code>npx webpack</code> ï¼Œ æˆåŠŸç»™ <code>node_modules</code> ä¸­çš„ <code>ffformat</code> æ•´å…¥ <code>polyfill</code> éƒ¨åˆ†çš„ä»£ç ã€‚çœ‹åˆ°è¿™ä¸ªç»“æœå·®ç‚¹æŠŠæˆ‘é€èµ°ã€‚ è¿™å¡äº†åŠå¤©çš„é—®é¢˜ï¼Œ æ”¹äº†ä¸ªåå­—å°±å¥½äº†ã€‚ã€‚ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758287255.jpeg" alt="" loading="lazy"></figure>
<h3 id="2-å¤šç§polyfillæ–¹å¼">2. å¤šç§polyfillæ–¹å¼</h3>
<ol>
<li>
<p>æŒ‰éœ€å¼•å…¥æ–¹å¼ï¼Œ ç”¨åˆ°å“ªä¸ªé«˜çº§ç‰¹æ€§ï¼Œ å°±è‡ªåŠ¨åŠ å…¥è¿™ä¸ªç‰¹æ€§çš„polyfillã€‚ ï¼ˆå³ æœ¬æ–‡å†™çš„æ–¹å¼ï¼‰</p>
</li>
<li>
<p>å…¨é‡å¼•å…¥æ–¹å¼ã€‚åœ¨å…¥å£æ–‡ä»¶é¡¶éƒ¨åŠ å…¥è¿™ä¸¤è¡Œã€‚</p>
<pre><code class="language-javascript">import &quot;core-js/stable&quot;;
import &quot;regenerator-runtime/runtime&quot;;
</code></pre>
</li>
<li>
<p>åŠ¨æ€å¼•å…¥æ–¹å¼ã€‚è¿™ä¸ªæ˜¯åœ¨ <a href="https://polyfill.io">polyfill.io</a> å»é…ç½®ä¸€ä¸ªå¤–é“¾ã€‚é…ç½®éœ€è¦å…¼å®¹çš„esç‰ˆæœ¬ æˆ–è€… éœ€è¦çš„å¯¹åº”apiã€‚ç„¶å ç”¨ script æ ‡ç­¾å¼•å…¥è¯¥å¤–é“¾ï¼Œ å°±ä¼šè¿”å›å¯¹åº”çš„ä¸€äº›<code>polyfill</code>ä»£ç ã€‚ï¼ˆå›  script çš„src å±äºgetè¯·æ±‚ï¼Œ æ‰€ä»¥æœåŠ¡å™¨é‚£è¾¹å¯ä»¥çŸ¥é“æˆ‘ä»¬æµè§ˆå™¨çš„ userAgentï¼Œ ç„¶åæ ¹æ®è¿™ä¸ªå»åˆ¤æ–­æˆ‘ä»¬æµè§ˆå™¨ï¼Œ ç»™æµè§ˆå™¨å“åº”å¯¹åº”çš„polyfillã€‚ æ‰€ä»¥ç”¨é«˜ç‰ˆæœ¬æµè§ˆå™¨å»è®¿é—®æ­¤è¯·æ±‚ï¼Œ å¯èƒ½è¿”å›çš„å†…å®¹æ˜¯ç©ºçš„ï¼‰</p>
</li>
</ol>
<p>ä¸‰ç§æ–¹å¼ï¼Œ æ„Ÿè§‰ç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§åå¥½ä¸€ç‚¹ã€‚</p>
<p>ç¬¬ä¸€ç§çš„æŒ‰éœ€å¼•å…¥ï¼Œ ä¸ä¼šå› ä¸ºå°±ä¸€ä¸ª é«˜çº§ç‰¹æ€§çš„apiï¼Œ å°±å¯¼è‡´æ•´ä¸ªbundleæ–‡ä»¶ç¬é—´å¢å¤§Nå¤šå€ã€‚</p>
<p>ç¬¬ä¸‰ç§åˆ™æ˜¯ æŒ‡å®šesç‰ˆæœ¬ï¼Œ ç”±æœåŠ¡å™¨å†³å®šéœ€è¦è¿”å›å“ªäº›polyfillã€‚è¿™æ ·ç›¸å½“äºæ˜¯å°†æ‰€æœ‰çš„polyfill éƒ½æŠ½ç¦»å‡ºå»ï¼Œç”¨åˆ«äººå®¶çš„cdnå¼•å…¥è¿›æ¥ã€‚</p>
<p>è‡³äºé€‰æ‹©ä¸Šï¼Œ å¦‚æœè¯´ è¯·æ±‚ <a href="https://polyfill.io">polyfill.io</a> çš„é€Ÿåº¦è¿‡æ…¢ï¼Œ æˆ–è€…é¡¹ç›®å†…ç½‘éƒ¨ç½²ï¼Œé‚£ä¹ˆé€‰æ‹©ç¬¬ä¸€ç§æ–¹å¼æ˜¯æ›´å¥½çš„ã€‚</p>
<p>è€Œå¦‚æœé¡¹ç›®å¯ä»¥è®¿é—®å¤–ç½‘èµ„æºã€‚å¹¶ä¸”è®¿é—® <a href="https://polyfill.io">polyfill.io</a> å¤–é“¾é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Œ é‚£ä¹ˆç”¨ç¬¬ä¸‰ç§ä¹Ÿæ˜¯æå¥½çš„ã€‚</p>
<p>å½“ç„¶ï¼Œ  å¦‚æœé¡¹ç›®æ²¡æœ‰æ¶‰åŠåˆ° <code>webpack</code>ï¼Œ <code>rollup</code>ä¹‹ç±»çš„æ„å»ºå·¥å…·ï¼Œ åªæ˜¯çº¯çš„é¡¹ç›®ï¼Œé‚£ä¹ˆåªèƒ½é€‰æ‹©ç¬¬ä¸‰ç§äº†ã€‚</p>
<p>å¦‚æœæ²¡ç”¨ æ„æ¶å·¥å…·ï¼Œ è¿˜è¦å†…ç½‘éƒ¨ç½²ï¼Œ é‚£å°±æŠŠå¤–é“¾çš„ polyfill ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°æœ¬åœ°å†ä¸€å¹¶éƒ¨ç½²ä¸Šå»ã€‚</p>
<figure data-type="image" tabindex="6"><img src="https://croatiaparanoia.github.io/blog//post-images/1609758295721.jpg" alt="" loading="lazy"></figure>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E5%90%AC%E9%97%BB%E4%BD%A0%E8%BF%99%E5%8C%85%E4%B8%8D%E6%84%BF%E7%BB%99%E6%88%91%E5%8A%A0polyfill">å¬é—»ä½ è¿™åŒ…ä¸æ„¿ç»™æˆ‘åŠ polyfillï¼Ÿ</a>
<ul>
<li><a href="#%E9%9A%8F%E4%BE%BF%E6%90%9E%E4%B8%AA%E9%A1%B9%E7%9B%AE">éšä¾¿æä¸ªé¡¹ç›®</a></li>
<li><a href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98">é‡åˆ°çš„é—®é¢˜</a>
<ul>
<li><a href="#1-babel-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98">1. Babel é…ç½®æ–‡ä»¶çš„é—®é¢˜</a></li>
<li><a href="#2-%E5%A4%9A%E7%A7%8Dpolyfill%E6%96%B9%E5%BC%8F">2. å¤šç§polyfillæ–¹å¼</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://croatiaparanoia.github.io/blog/post/event-loop/">
              <h3 class="post-title">
                Event Loop
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '344de4a7a0e3121bcdbc',
    clientSecret: 'cf3ede59043d5bf3f50b37b93791396bb4d1267e',
    repo: 'blog',
    owner: 'CroatiaParanoia',
    admin: ['CroatiaParanoia'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://croatiaparanoia.github.io/blog//atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
